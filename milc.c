#include <assert.h>
#include <stdio.h>
#include <time.h>

#include "milc.h"

bool contains_uncompressed(uint32_t n, uint32_t* uncompressed, uint32_t value) {
	int l = 0, r = n - 1;
	while (l <= r) {
		int mid = l + (r - l) / 2;
		uint32_t result = uncompressed[mid];
		if (result == value) return true;
		if (result < value) l = mid + 1;
		else r = mid - 1;
	}
	return false;
}

int timings(uint32_t n, uint32_t* sorted, uint32_t max_num) {
	printf("Processing %d elements [%ld bytes]\n", n, n * sizeof(uint32_t));
	unsigned char *v1, *v2, *v3, *v4, *v5, *simdized;
	clock_t start, end;

	start = clock();
	size_t v1_size = compress_v1(&v1, n, sorted);
	end = clock();
	printf("Compressed v1 in %f seconds [ratio=%f]\n", ((double) (end - start)) / CLOCKS_PER_SEC, (double) (n * sizeof(uint32_t)) / v1_size);	

	start = clock();
	size_t v2_size = compress_v2(&v2, n, sorted);
	end = clock();
	printf("Compressed v2 in %f seconds [ratio=%f]\n", ((double) (end - start)) / CLOCKS_PER_SEC, (double) (n * sizeof(uint32_t)) / v2_size);	

	start = clock();
	size_t v3_size = compress_v3(&v3, n, sorted);
	end = clock();
	printf("Compressed v3 in %f seconds [ratio=%f]\n", ((double) (end - start)) / CLOCKS_PER_SEC, (double) (n * sizeof(uint32_t)) / v3_size);	

	start = clock();
	size_t v4_size = compress_v4(&v4, n, sorted);
	end = clock();
	printf("Compressed v4 in %f seconds [ratio=%f]\n", ((double) (end - start)) / CLOCKS_PER_SEC, (double) (n * sizeof(uint32_t)) / v4_size);	

	start = clock();
	size_t v5_size = compress_v5(&v5, n, sorted);
	end = clock();
	printf("Compressed v5 in %f seconds [ratio=%f]\n", ((double) (end - start)) / CLOCKS_PER_SEC, (double) (n * sizeof(uint32_t)) / v5_size);	

	start = clock();
	size_t simd_size = simdize(&simdized, n, sorted);
	end = clock();
	printf("SIMDized in %f seconds [ratio=%f]\n", ((double) (end - start)) / CLOCKS_PER_SEC, (double) (n * sizeof(uint32_t)) / simd_size);	

	const uint32_t STOP = max_num;
	const uint32_t STEP = 1;

	start = clock();
	for (uint32_t i = 0; i < STOP; i += STEP) {
		contains_v1(v1, i);
	}
	end = clock();
	printf("V1 took %f seconds [%ld bytes]\n", ((double) (end - start)) / CLOCKS_PER_SEC, v1_size);

	start = clock();
	for (uint32_t i = 0; i < STOP; i += STEP) {
		contains_v2(v2, i);
	}
	end = clock();
	printf("V2 took %f seconds [%ld bytes]\n", ((double) (end - start)) / CLOCKS_PER_SEC, v2_size);

	start = clock();
	for (uint32_t i = 0; i < STOP; i += STEP) {
		contains_v3(v3, i);
	}
	end = clock();
	printf("V3 took %f seconds [%ld bytes]\n", ((double) (end - start)) / CLOCKS_PER_SEC, v3_size);

	start = clock();
	for (uint32_t i = 0; i < STOP; i += STEP) {
		contains_v4(v4, i);
	}
	end = clock();
	printf("V4 took %f seconds [%ld bytes]\n", ((double) (end - start)) / CLOCKS_PER_SEC, v4_size);

	start = clock();
	for (uint32_t i = 0; i < STOP; i += STEP) {
		contains_v5(v5, i);
	}
	end = clock();
	printf("V5 took %f seconds [%ld bytes]\n", ((double) (end - start)) / CLOCKS_PER_SEC, v5_size);

	start = clock();
	for (uint32_t i = 0; i < STOP; i += STEP) {
		contains_uncompressed(n, sorted, i);
	}
	end = clock();
	printf("Uncompressed took %f seconds [%ld bytes]\n", ((double) (end - start)) / CLOCKS_PER_SEC, n * sizeof(uint32_t));
	
	start = clock();
	for (uint32_t i = 0; i < STOP; i += STEP) {
		contains_simdized(n, simdized, i);
	}
	end = clock();
	printf("SIMD-ized took %f seconds [%ld bytes]\n", ((double) (end - start)) / CLOCKS_PER_SEC, simd_size);

	free(v1);
	free(v2);
	free(v3);
	free(v4);
	free(v5);
	free(simdized);
}

int validate()
{
	uint32_t sorted[] = {11707,13259,22466,30756,32710,39656,40405,44358,45730,45924,49369,50681,61191,71323,71580,81553,91981,104055,108183,120447,124205,125045,126797,136622,136898,140997,161251,164967,187313,190189,194472,195546,195881,196955,201670,205135,226855,229221,242281,261482,274306,276962,284485,285533,286137,290893,299138,301246,301344,304335,311664,312160,324943,327143,328201,329570,329760,331682,334116,339459,358712,359931,361698,363779,364021,366513,368432,369362,369597,377694,385240,386783,394112,394792,402122,405112,405250,416311,430947,438344,441241,441916,446139,452211,454399,458396,464455,464884,468338,471976,477170,480250,489743,494111,506126,512882,513795,516478,516899,521503,523910,526800,527540,529796,543145,543238,543686,552215,552523,557342,559110,568605,569240,572718,572765,577101,579692,580055,582554,582993,584295,587756,596327,600675,601822,608431,610802,611391,615112,615808,618712,620076,627270,627415,636320,647435,647517,657060,668882,669877,671189,678141,685412,690175,691213,693507,695870,700206,703888,712951,717994,720499,730929,736329,741185,748639,749300,769211,769875,772962,775251,781092,781756,781910,782566,784471,792080,794442,802555,804446,816409,817285,819903,828339,839073,846350,846681,859360,864241,864519,865975,881013,896147,902321,906375,909252,910120,926552,932040,932285,943822,945329,951705,953253,955865,957181,959322,968030,969912,970370,973531,974461,983118,987876,997756,1002169,1005591,1006775,1012574,1016767,1027557,1044140,1047993,1048112,1052990,1056788,1075629,1086376,1086837,1089200,1104828,1104981,1112746,1113750,1125113,1128586,1132044,1138240,1146029,1152038,1162350,1163404,1170510,1174066,1174068,1178745,1193335,1219676,1228715,1229461,1232417,1245485,1251924,1254723,1258089,1261024,1267820,1268974,1270153,1270447,1271330,1277533,1282342,1283587,1284841,1285233,1296340,1303304,1304677,1320482,1322279,1339746,1343365,1343645,1357039,1359474,1363465,1365555,1381485,1385987,1406659,1414213,1416553,1424385,1428346,1439930,1442163,1448268,1449571,1456816,1457683,1465368,1466618,1473261,1482078,1483493,1485508,1491909,1495846,1500424,1503397,1505481,1506559,1523003,1524260,1529534,1539012,1544418,1549192,1552426,1561153,1571857,1573637,1578105,1582954,1588761,1608075,1610075,1613500,1620562,1620985,1624474,1627714,1631997,1635253,1635257,1638888,1643848,1660361,1663150,1676164,1677690,1685322,1697873,1700233,1704136,1714089,1724255,1728858,1729573,1733741,1749866,1753567,1772620,1781829,1787569,1802279,1803462,1805815,1814596,1815085,1815852,1822076,1830419,1831175,1846998,1868561,1877581,1879754,1880845,1883921,1884062,1885274,1888688,1894303,1894390,1897724,1899262,1901995,1905612,1912459,1913570,1913920,1916256,1920362,1922558,1927743,1930173,1939859,1940027,1948963,1951689,1952713,1957882,1962037,1962129,1962969,1967325,1973443,1978781,1979501,2002650,2003621,2009962,2010119,2013773,2013976,2016097,2020566,2020703,2026788,2027679,2034896,2035514,2036295,2038666,2039845,2045913,2051723,2053668,2054836,2059619,2062765,2066395,2066463,2072176,2084402,2097282,2099825,2100378,2102007,2115693,2122263,2129020,2135291,2138066,2146012,2147841,2159902,2161421,2163242,2170383,2179329,2180714,2181388,2207694,2213955,2230891,2233146,2243171,2249304,2251641,2255109,2257638,2268131,2273665,2279155,2279401,2286919,2294903,2301874,2312787,2314643,2320237,2330117,2332846,2334931,2342892,2346741,2350735,2352751,2358946,2361179,2364707,2372593,2375259,2380329,2384084,2398737,2404924,2406279,2410919,2411136,2411420,2417677,2420546,2422899,2427205,2427840,2432257,2434696,2439719,2441744,2451387,2458680,2473293,2474718,2476684,2486325,2490041,2493705,2494694,2496830,2500704,2506657,2512999,2521690,2529007,2529205,2532520,2554322,2556660,2566111,2569371,2579976,2593905,2598526,2598707,2601852,2605846,2620389,2623149,2623336,2631035,2631295,2636339,2638683,2645826,2648583,2650850,2652137,2655060,2664822,2668502,2676598,2683383,2691113,2692282,2693224,2698756,2729026,2743089,2749744,2752671,2754622,2755466,2756084,2758944,2759744,2760113,2760862,2765132,2765310,2768580,2769782,2782389,2785267,2785633,2791164,2791824,2795469,2800539,2802072,2802492,2810316,2810361,2816469,2826624,2829289,2829838,2839649,2844145,2848949,2852362,2854838,2855668,2860931,2889628,2890186,2893903,2901893,2914705,2921713,2926449,2929469,2932745,2935956,2937187,2943443,2950524,2953935,2958659,2976650,2983648,2988867,2990894,2991102,2996389,3003192,3017180,3017800,3036444,3040156,3044463,3045099,3047960,3055585,3060828,3066638,3084859,3088784,3088993,3089529,3103274,3105636,3112802,3121396,3130833,3143441,3152531,3157226,3163563,3164191,3171706,3189418,3191126,3191891,3197016,3206667,3229745,3239124,3243845,3244544,3245787,3246112,3246602,3249974,3252392,3255469,3265784,3266951,3270268,3271259,3279088,3283149,3283239,3288543,3289242,3307677,3316850,3326301,3347969,3349311,3366835,3374446,3382783,3388894,3401733,3409245,3416233,3417273,3420125,3420531,3422863,3425757,3428655,3431745,3438401,3438768,3440197,3444907,3447534,3457396,3460451,3461677,3468313,3481824,3483871,3488954,3491339,3492417,3494153,3497061,3497778,3503080,3503165,3508149,3516160,3522850,3523822,3532135,3532162,3536931,3539591,3549515,3557957,3558967,3560355,3560407,3565789,3568758,3575251,3584983,3585476,3591448,3591913,3595360,3595810,3596147,3597871,3601298,3601560,3605274,3608064,3608934,3623227,3625581,3626359,3634655,3637027,3639045,3639186,3640215,3646085,3646504,3655751,3664490,3667242,3668223,3675207,3679011,3682317,3685174,3699222,3708173,3710277,3716923,3717546,3735181,3749346,3758059,3762199,3773417,3775229,3778029,3784400,3786701,3789041,3802264,3805192,3805387,3806772,3806857,3808691,3813672,3823237,3824260,3825858,3840129,3842638,3843088,3849456,3855192,3857689,3863743,3883616,3886311,3890354,3901744,3905474,3907295,3914600,3921602,3927066,3929353,3931585,3932794,3951412,3951992,3954074,3954916,3966871,3971151,3973329,3979362,3984869,3984887,3991746,4001008,4002368,4006913,4007154,4011236,4011713,4013467,4024779,4032862,4034554,4038924,4043459,4044281,4052258,4068080,4071901,4072722,4081474,4083344,4088924,4095790,4096543,4097571,4098843,4124867,4135622,4143565,4157900,4167576,4182518,4190724,4191770,4197024,4199134,4205252,4208610,4208724,4208918,4210109,4211455,4211472,4222492,4226934,4238232,4247240,4247564,4248342,4254710,4258399,4266549,4268389,4268749,4269867,4275107,4276134,4279981,4301882,4302577,4308903,4312627,4314683,4321806,4321949,4321995,4323593,4324085,4324396,4329274,4330196,4331226,4334280,4338952,4339364,4343004,4352566,4353200,4357193,4361345,4364042,4370225,4371022,4371321,4372892,4380531,4385756,4403127,4404078,4406012,4410044,4411662,4411896,4416641,4417256,4418688,4424590,4441015,4442838,4443896,4444028,4447087,4450400,4452883,4454497,4457115,4466570,4484174,4487915,4495885,4505600,4508835,4510661,4513469,4514188,4517446,4520048,4522936,4530959,4532722,4532777,4539350,4550990,4552263,4554113,4562758,4574815,4577645,4581429,4581822,4585375,4589399,4590208,4593366,4594624,4602357,4612490,4614294,4617526,4617753,4617778,4619336,4623536,4633216,4650559,4651017,4652490,4652801,4653905,4657307,4661063,4662627,4662868,4669609,4694464,4733496,4735126,4748061,4751384,4760657,4763137,4764935,4766958,4771709,4772927,4772952,4792927,4797436,4797853,4801759,4802169,4802305,4804471,4809526,4816360,4824653,4825707,4843514,4847499,4850676,4855623,4863262,4864588,4865598,4867556,4871744,4881345,4884538,4885952,4890544,4893348,4903943,4905212,4913607,4913788,4924232,4927120,4928707,4933621,4946294,4958137,4958295,4975557,4977439,4978104,4979877,4991614,4991944,4992322,4992382,4993451,5003138,5003491,5017605,5019162,5019559,5022508,5040796,5041238,5042012,5048743,5048965,5068807,5087332,5089713,5092986,5100235,5110534,5123263,5123518,5124321,5133961,5136525,5143538,5150197,5178613,5181144,5182020,5185897,5186121,5196863,5199511,5200371,5224772,5230666,5236791,5245833,5256045,5258005,5263645,5270408,5273137,5278776,5281243,5284089,5290983,5299074,5301004,5307586,5308489,5312893,5316872,5320072,5327381,5329084,5332672,5339310,5339545,5352387,5357211,5357545,5364576,5367063,5370600,5372238,5373417,5374522,5376356,5388786,5400870,5403004,5404079,5408431,5409300,5409746,5413062,5421302,5425753,5430307,5431164,5438781,5442733,5449433,5450208,5453490,5453870,5455636,5458559,5467298,5467641,5467851,5468614,5471010,5471234,5474455,5488472,5500089,5500487,5503629,5507733,5510262,5533287,5534281,5539263,5546504,5547926,5548062,5560845,5571909,5576941,5593324,5594216,5605056,5609307,5609503,5640579,5646216,5648405,5649366,5656730,5660678,5665691,5669204,5693677,5694704,5695693,5697272,5698211,5699551,5704393,5707689,5711880,5712401,5716586,5719890,5720719,5729319,5745883,5756208,5778513,5781596,5784448,5799601,5804477,5813301,5823937,5827099,5827413,5836633,5836685,5839394,5846273,5849894,5851029,5874353,5875169,5883960,5890637,5895047,5899089,5902244,5906038,5912604,5916839,5920654,5920828,5922918,5928204,5930474,5931215,5934319,5937585,5939600,5943090,5949975,5959636,5960895,5966535,5970952,5974509,5976293,5977149,5979443,5980808,5988990,6004483,6007654,6017986,6020308,6021282,6021725,6022446,6025712,6030590,6049704,6051662,6054381,6060959,6064073,6067708,6070579,6088242,6093670,6094060,6094300,6097243,6098471,6113386,6116800,6142328,6147772,6148662,6161936,6169113,6169482,6171131,6175753,6177019,6183379,6191657,6193550,6196119,6196709,6197510,6200949,6201791,6214714,6217835,6220068,6221053,6228535,6229655,6231114,6235592,6241918,6247338,6253640,6254912,6256296,6263597,6273088,6274378,6280757,6281599,6282019,6282229,6283988,6297629,6301252,6310435,6313831,6314170,6315697,6315877,6316000,6317967,6322806,6325077,6328253,6337234,6338991,6348350,6349029,6349111,6352931,6354829,6357911,6359438,6381332,6382099,6385380,6394237,6397070,6399184,6403566,6404068,6408917,6417232,6422340,6423800,6425685,6431173,6433011,6436994,6453574,6457989,6461119,6462114,6463784,6464984,6466540,6470644,6485992,6494901,6497651,6508566,6511170,6513966,6517231,6517667,6518767,6528825,6533751,6546220,6549945,6553813,6564519,6569022,6574673,6586321,6599615,6601364,6603884,6605401,6615508,6617340,6619619,6623999,6631783,6635744,6637496,6644226,6646301,6654284,6659811,6664297,6665182,6669176,6672567,6674175,6677247,6690026,6692367,6693318,6696578,6697461,6703906,6708546,6714175,6716606,6717023,6717767,6723738,6725599,6727971,6727996,6730164,6730915,6731511,6737247,6741784,6742082,6750417,6755695,6758867,6762162,6770561,6771276,6780364,6784271,6788921,6791209,6797623,6806433,6812526,6815983,6819373,6819546,6820598,6823925,6826992,6832636,6834468,6851930,6862396,6868297,6869352,6872478,6876229,6878353,6889013,6897858,6913737,6921913,6930095,6934894,6939741,6945479,6945684,6962896,6963997,6966169,6966279,6976574,6985782,6986612,6989300,6999620,7001869,7008267,7011889,7016571,7026442,7031131,7042865,7046038,7057207,7076741,7085594,7086470,7092554,7093493,7096026,7100337,7105364,7110961,7112438,7115199,7119877,7125032,7128991,7134408,7147581,7148459,7155940,7158347,7162372,7167506,7167614,7168321,7179772,7188488,7201956,7216401,7227816,7229570,7233213,7271523,7272856,7284189,7311993,7327164,7329472,7330849,7335544,7342206,7343117,7347866,7352988,7357882,7359732,7362730,7368051,7374196,7374672,7387612,7403549,7404698,7412124,7413369,7414567,7415785,7419680,7419946,7420457,7421291,7424972,7429513,7439608,7448704,7448725,7449877,7453575,7454628,7458366,7458807,7459890,7472521,7478800,7492613,7497563,7499731,7500581,7502647,7506402,7507034,7508471,7509900,7510523,7511327,7514974,7515708,7523390,7534633,7561158,7564255,7579204,7585482,7597917,7614965,7616869,7620132,7621866,7634861,7636341,7641890,7643113,7657819,7659624,7659853,7663978,7664708,7665596,7667609,7675867,7678805,7679863,7693801,7702156,7721385,7721770,7726606,7727860,7728227,7731307,7733129,7733233,7736145,7738388,7740055,7755206,7770367,7775969,7777580,7782346,7784940,7786932,7788405,7790930,7792314,7803967,7804135,7805158,7809334,7824627,7829445,7829578,7835510,7842602,7843170,7848670,7851808,7857954,7859234,7865224,7868071,7868816,7877588,7884443,7885452,7892279,7900400,7905700,7914312,7939362,7941537,7944271,7954448,7960666,7963403,7974785,7985722,7989717,7990823,7990894,7993944,8002852,8007689,8008334,8010850,8022222,8024250,8025010,8031234,8039855,8046906,8047796,8050441,8054420,8056399,8058517,8062145,8067726,8068019,8074079,8093163,8095559,8095660,8100579,8107589,8107995,8109123,8111328,8113717,8115797,8124792,8130384,8135221,8146431,8147011,8147984,8148086,8149876,8150267,8156046,8156708,8174779,8177921,8180194,8180561,8181844,8187417,8192649,8194071,8205797,8223429,8225750,8238249,8238519,8244478,8248096,8250711,8255350,8258335,8260106,8262072,8262181,8271280,8272669,8272675,8275231,8275265,8289456,8293545,8297723,8299130,8303717,8310525,8314631,8315625,8316778,8320646,8323076,8324460,8327352,8329221,8342751,8352032,8353570,8354618,8356826,8365278,8366203,8369092,8381680,8390023,8393563,8401096,8401267,8407416,8416156,8417317,8433869,8438515,8442750,8443135,8443705,8443777,8448869,8453609,8460555,8463384,8466499,8467735,8468351,8469092,8471803,8495428,8497204,8500110,8500943,8506570,8507734,8510094,8515721,8519990,8522810,8526529,8526687,8530079,8531844,8532078,8536069,8539487,8548811,8559742,8563107,8566610,8572624,8573571,8576178,8579971,8581800,8584216,8588926,8590512,8591573,8595617,8598373,8602183,8605369,8608830,8611492,8617282,8619779,8621846,8627399,8633946,8634803,8639303,8641237,8657470,8658660,8664063,8665061,8683305,8683406,8685001,8691039,8712812,8714196,8723993,8732077,8734551,8752939,8768367,8769697,8770696,8771235,8779310,8779457,8794515,8795881,8797976,8800483,8820728,8830155,8831394,8833214,8835007,8842801,8852703,8852840,8853777,8860136,8862528,8862690,8866168,8871276,8873692,8881437,8882391,8883962,8884624,8888298,8893518,8897242,8914323,8915756,8917005,8934985,8940065,8947220,8947280,8947432,8950044,8952134,8954835,8956901,8959561,8961267,8965122,8973984,8980309,8992580,8998322,9002489,9010807,9015340,9030723,9037495,9045799,9063850,9067673,9074708,9074865,9079655,9082274,9083046,9090887,9096162,9099847,9107315,9108612,9109287,9111073,9112276,9128537,9128592,9136888,9138953,9140939,9141479,9145144,9161711,9166734,9167519,9178620,9197402,9204982,9207564,9209640,9212984,9216600,9219353,9225267,9233929,9242657,9251836,9260073,9261024,9261933,9266320,9271679,9275696,9279949,9282612,9296395,9300892,9302276,9313424,9319163,9319710,9325583,9326414,9329514,9330065,9331981,9334542,9340122,9340795,9342125,9352795,9370978,9382178,9382247,9391120,9392549,9393203,9394975,9395624,9396235,9401489,9406027,9408157,9418474,9423418,9426995,9428528,9434556,9435330,9442827,9449727,9459241,9462617,9481287,9495939,9496933,9502214,9512958,9514332,9528805,9534206,9536787,9537476,9538486,9539719,9547685,9556316,9563107,9567970,9570236,9571689,9571961,9573364,9573919,9575043,9592347,9597214,9597745,9607453,9609886,9615702,9618652,9618684,9627908,9629283,9631072,9643559,9645473,9655527,9657081,9657331,9665236,9680148,9687693,9688138,9689031,9690148,9691397,9694633,9701150,9702937,9706651,9708886,9711887,9713523,9716339,9727444,9727570,9734505,9755750,9770736,9779759,9786310,9796680,9804014,9812673,9812735,9815605,9817601,9837740,9848145,9848573,9853537,9855037,9855710,9862293,9864705,9868725,9875087,9884431,9889053,9892108,9892834,9893226,9901075,9908158,9919163,9919554,9926034,9927338,9933492,9938979,9951541,9954915,9955445,9955546,9959025,9962656,9981937,9994649,10000287,10009710,10014934,10018350,10018499,10019623,10019834,10023904,10028347,10029999,10035078,10042137,10047050,10048425,10063409,10070710,10076294,10102790,10106327,10111917,10115453,10118576,10119088,10120934,10124153,10125030,10125526,10127926,10134694,10141366,10143046,10143901,10147849,10149108,10172473,10172489,10172958,10173809,10173983,10175812,10177924,10181408,10183091,10189411,10189637,10190269,10192714,10194771,10202026,10202326,10213306,10225974,10235737,10240159,10241667,10243381,10247280,10254188,10254254,10265397,10265431,10265473,10266890,10266923,10269344,10277250,10290876,10299374,10300762,10302894,10305358,10306849,10314165,10315716,10318833,10323000,10327956,10329217,10335864,10338575,10345843,10348385,10351950,10357750,10357982,10391758,10393132,10393845,10395421,10402280,10402760,10420279,10429145,10431527,10433993,10434056,10435460,10436137,10441080,10448188,10450495,10450855,10453873,10460700,10468892,10473224,10479285,10480143,10481206,10484862,10485150,10486358,10492286,10496335,10496547,10507515,10514082,10523163,10532833,10534608,10538200,10541932,10544639,10548273,10559607,10560870,10561767,10562537,10568737,10569574,10569740,10570013,10576153,10580285,10594811,10597872,10604281,10605617,10612293,10613626,10613967,10615230,10615591,10620183,10637185,10644260,10647023,10649143,10655075,10656753,10657267,10665895,10668556,10675123,10677617,10685741,10691588,10692855,10700527,10706358,10707243,10708808,10710795,10721282,10725761,10736548,10737622,10756559,10760412,10761418,10762704,10764949,10766474,10769155,10769670,10770664,10771135,10772619,10779389,10779713,10783213,10786625,10787934,10797372,10798058,10805999,10806311,10806909,10807021,10809206,10829976,10835836,10835963,10842038,10855441,10855869,10869532,10871745,10871984,10877025,10881071,10882385,10882891,10884080,10887701,10888835,10892583,10897234,10900884,10903771,10910153,10925649,10935123,10937309,10940335,10940714,10952495,10953285,10955914,10959517,10971147,10973095,10974956,10976464,10977177,10978712,10989918,10993272,11000201,11007928,11008319,11010787,11020867,11021598,11028031,11028852,11034903,11041129,11042159,11042708,11053683,11060280,11067670,11068492,11069062,11073099,11074892,11077396,11077750,11079640,11081967,11085470,11103350,11104320,11119615,11124837,11128339,11129275,11130109,11132191,11132208,11143057,11144672,11146272,11147487,11148953,11150481,11152584,11153438,11157064,11169642,11174096,11177741,11178277,11180453,11189730,11191795,11191999,11192194,11195706,11196257,11199460,11203447,11214481,11216538,11218883,11221998,11222122,11230575,11232744,11244949,11248491,11255521,11255962,11257355,11265484,11265639,11273983,11274587,11281680,11284174,11285600,11298758,11301274,11301506,11302869,11310140,11312065,11318350,11321731,11327325,11350273,11353740,11361963,11364815,11366085,11366994,11379078,11380503,11394378,11394612,11398261,11403482,11427745,11437287,11437701,11440202,11445823,11446595,11456676,11463658,11466853,11467946,11471856,11480617,11481908,11490998,11494352,11497409,11512080,11513729,11515427,11518835,11526500,11533346,11534836,11541380,11542897,11544008,11544554,11556166,11559435,11578739,11579839,11589713,11608574,11616486,11618560,11620746,11621418,11625737,11634558,11635588,11640024,11649671,11651622,11657681,11658325,11664074,11668157,11676490,11679158,11681166,11681581,11683022,11684236,11687692,11692987,11693318,11695557,11696981,11697409,11698279,11700351,11706975,11708466,11711053,11711466,11712014,11714901,11716640,11717775,11720022,11737143,11738373,11759458,11759948,11760457,11763768,11765353,11771251,11776277,11778889,11785021,11785149,11810535,11812889,11816616,11825290,11825539,11830578,11848109,11849205,11853229,11855963,11859510,11860421,11864631,11864689,11870583,11876361,11877188,11884091,11884451,11893096,11893399,11901042,11918737,11921211,11923282,11924420,11924906,11928420,11930387,11933030,11939334,11940004,11940964,11941516,11943521,11948389,11948496,11949827,11950742,11959699,11968112,11968381,11972841,11973256,11974510,11979087,11984160,11985386,11985970,11990394,11995944,11996933,12010782,12017050,12019488,12026979,12031108,12035202,12035685,12052287,12054160,12057982,12058431,12061969,12066405,12067482,12067593,12080118,12089311,12089319,12103798,12106490,12109961,12111836,12118182,12132833,12137585,12146845,12152371,12158569,12159138,12168180,12174526,12175486,12175915,12176869,12178613,12179551,12186687,12189728,12199250,12208692,12210121,12211351,12214337,12220944,12230278,12232903,12235477,12235705,12248073,12267665,12268186,12270034,12271619,12276182,12276677,12281196,12285449,12286623,12295937,12296426,12300575,12305914,12306594,12323631,12326573,12332797,12339855,12350651,12360757,12361260,12364612,12366987,12369422,12373428,12375520,12377406,12383258,12390784,12392675,12396316,12397578,12402327,12408976,12426737,12438771,12440828,12445676,12447392,12447750,12450206,12457896,12467296,12468461,12468531,12472657,12483198,12488120,12489092,12495613,12499046,12502668,12503091,12509216,12509413,12516190,12528686,12530531,12533354,12539235,12539572,12548354,12551187,12556320,12559505,12562015,12562736,12564462,12565565,12605137,12611687,12614949,12627123,12629474,12629921,12634348,12644004,12651061,12662802,12665531,12671715,12688572,12714358,12735164,12748160,12755094,12756875,12759472,12766106,12773399,12773577,12774160,12782400,12783493,12789697,12790229,12797092,12805039,12807886,12809808,12810508,12813301,12815462,12818052,12818505,12829537,12837657,12837922,12847840,12853844,12860438,12862475,12884369,12885322,12899047,12900857,12905135,12925884,12927180,12927332,12933810,12934839,12938452,12941607,12951792,12952929,12955004,12961969,12963802,12966823,12967966,12969276,12983822,12991108,12993389,12997288,12997493,13004019,13006710,13008856,13012855,13013271,13015033,13015164,13018229,13022733,13033671,13041533,13053299,13068714,13071077,13072134,13082296,13083929,13091483,13100869,13102638,13106363,13107843,13117636,13122452,13126998,13130301,13131198,13132539,13135801,13140348,13162510,13174399,13183542,13184219,13187165,13189326,13192383,13196228,13220179,13223695,13227121,13228385,13232354,13235498,13249764,13250048,13250446,13254352,13260903,13292570,13296517,13303450,13319304,13322581,13329200,13332885,13334005,13353826,13364516,13365079,13366787,13369703,13372757,13372819,13374110,13375873,13383703,13390439,13396307,13396502,13417156,13426751,13435161,13436916,13437323,13458374,13458441,13462348,13471479,13473256,13476382,13485587,13491073,13500647,13502504,13506304,13509895,13520876,13525881,13525911,13530970,13534114,13535779,13536869,13538394,13579881,13580269,13580277,13582207,13584138,13586842,13609737,13610135,13613156,13613260,13615919,13616314,13618645,13619166,13630334,13643108,13646941,13649698,13652192,13655685,13655769,13668156,13673436,13684636,13685752,13694185,13695154,13697021,13703538,13704249,13713519,13716768,13716952,13731562,13733208,13747018,13762681,13771908,13782754,13786365,13786714,13792935,13799170,13804901,13807476,13808893,13812212,13817381,13819458,13821314,13823148,13828797,13833318,13847947,13856725,13860739,13886061,13905431,13908339,13908696,13910170,13912206,13913705,13915447,13916577,13918317,13923816,13928400,13933348,13933598,13947408,13949291,13957981,13958119,13958123,13971358,13973793,13973828,13977122,13980636,13982899,13987693,13988054,13994135,13994431,14012278,14023065,14023451,14032026,14039061,14045423,14052390,14055789,14057380,14058662,14064413,14066369,14075676,14078874,14085195,14100133,14104403,14112416,14118744,14123846,14128363,14133450,14134188,14140971,14141688,14144942,14145800,14155235,14158825,14160771,14165668,14169065,14172887,14174563,14185374,14188649,14191107,14191373,14193106,14195932,14197619,14201897,14208573,14209261,14209941,14210604,14216042,14216863,14221761,14222026,14222241,14233227,14233229,14239553,14242744,14252410,14263333,14263872,14271162,14278791,14289570,14289670,14296159,14297177,14301399,14305478,14307394,14314309,14317107,14322812,14332428,14333346,14336453,14338879,14344804,14350886,14357383,14361463,14368977,14371612,14378333,14385552,14392253,14398083,14401014,14403384,14405741,14412154,14415993,14423585,14423809,14425550,14438937,14439456,14445178,14445748,14452805,14456484,14457404,14460693,14465146,14467889,14468033,14470495,14473427,14478620,14478877,14484052,14486869,14486887,14489266,14489666,14492544,14503227,14510208,14513713,14523299,14544734,14545685,14555036,14561255,14562889,14568656,14568771,14568958,14569230,14579498,14588155,14594050,14601213,14605648,14605757,14605817,14606114,14622315,14622945,14625444,14628519,14628587,14629148,14630521,14637967,14643539,14644105,14650501,14653551,14657619,14667442,14698592,14701598,14701978,14702514,14703508,14706046,14713183,14715918,14720875,14727418,14730133,14734997,14735893,14741182,14750235,14756150,14760504,14763443,14766714,14776797,14787078,14788721,14790078,14790178,14793338,14795185,14799527,14804274,14804491,14812494,14817865,14824907,14831064,14832956,14833239,14833911,14843561,14852963,14854621,14856167,14857213,14863956,14864495,14873798,14874480,14877496,14877786,14880852,14882737,14891499,14898253,14901584,14902932,14905243,14915648,14916209,14920023,14920849,14939881,14939940,14947669,14948302,14950175,14965631,14967722,14968713,14971577,14974573,14975349,14976731,14986281,14993213,15001197,15004140,15008715,15020552,15030903,15038643,15039720,15041980,15053263,15053787,15055217,15061831,15062400,15064760,15084398,15084982,15089069,15093518,15098257,15098337,15101301,15101787,15102027,15112759,15121621,15129803,15130910,15140400,15147964,15153701,15154959,15155665,15157997,15158306,15158421,15161638,15168779,15176016,15179121,15182175,15184733,15188053,15188406,15191275,15197719,15206066,15217470,15219491,15219887,15220832,15224945,15228932,15231952,15236189,15238498,15238877,15242793,15243120,15243442,15253592,15264602,15266586,15266841,15270723,15271687,15278125,15283567,15285350,15293744,15297319,15300213,15301729,15302199,15302251,15302400,15304480,15309970,15320178,15326825,15328391,15328492,15332170,15337536,15339198,15341796,15342750,15350403,15377235,15385574,15386254,15390352,15392866,15397844,15407015,15409932,15412615,15422500,15425550,15439671,15455101,15471869,15474254,15479622,15487402,15490801,15497052,15497962,15500270,15508367,15509511,15510712,15517019,15525794,15530867,15547498,15549484,15551173,15556480,15562546,15566921,15579268,15582043,15604405,15618425,15619505,15623998,15625820,15628250,15628383,15632401,15640463,15652103,15656663,15657793,15660848,15661784,15684740,15688949,15696749,15698981,15700579,15708705,15713745,15715748,15720687,15723102,15725232,15726442,15732471,15740762,15753292,15759501,15763253,15783662,15785439,15797124,15798437,15824943,15827369,15834707,15837989,15840140,15840946,15855661,15867585,15870222,15872862,15876757,15878730,15880753,15883404,15887316,15892987,15900859,15907068,15907624,15908834,15914607,15915200,15922737,15926139,15926666,15928759,15935817,15951023,15954188,15960086,15962593,15969236,15972657,15986631,15987451,15993591,15994389,16010277,16019672,16036993,16040266,16050558,16058827,16063862,16072946,16090027,16091718,16098915,16103422,16103453,16103682,16107288,16116232,16118640,16121170,16122611,16124238,16128326,16132555,16133092,16137584,16143239,16144793,16146747,16159709,16163418,16173513,16177227,16177726,16180964,16186577,16208495,16208895,16214301,16217642,16217855,16224671,16225904,16227344,16227432,16232287,16252949,16264311,16272024,16280758,16280816,16283154,16287978,16290344,16300113,16303205,16308352,16331803,16333231,16338464,16341782,16347278,16349180,16354168,16355913,16357345,16360526,16362409,16369097,16374105,16377364,16379414,16385289,16387101,16394695,16399877,16405169,16407609,16421886,16422127,16425623,16428112,16428869,16444368,16447459,16448139,16450421,16451826,16453726,16454322,16456309,16457563,16459834,16462583,16463926,16470113,16472498,16482735,16496538,16528785,16529712,16529977,16531162,16537084,16542481,16544793,16545109,16550823,16556426,16560618,16575391,16580701,16585278,16603759,16609991,16614576,16648092,16650131,16650763,16653044,16654990,16665137,16679979,16682188,16684721,16688119,16704416,16722452,16724201,16726412,16731585,16733621,16736643,16743888,16756956,16757523,16767100,16768354,16770552,16783451,16783574,16789859,16791360,16793768,16794742,16796761,16797260,16802312,16810539,16823048,16843024,16845833,16847070,16847208,16849744,16850879,16853642,16855826,16858904,16864251,16865270,16866152,16879059,16885391,16886001,16886516,16897629,16900263,16904087,16910146,16922251,16924093,16938383,16942095,16956045,16960886,16967269,16967459,16975219,16978492,16985197,16988717,16989507,16989733,16991745,16994251,17001566,17008788,17010462,17011984,17016738,17018064,17027217,17045491,17048070,17048094,17057886,17059767,17071122,17082206,17085771,17093676,17103832,17113173,17124685,17128626,17151758,17156297,17157957,17159854,17183845,17193136,17195361,17211403,17219971,17220578,17223511,17231015,17232694,17232972,17240861,17255268,17255663,17256168,17264535,17265038,17265976,17271386,17274709,17277244,17279740,17283729,17284830,17294795,17303821,17310476,17324081,17324787,17325304,17344614,17351336,17356573,17361207,17362607,17364180,17366626,17372203,17386018,17390333,17392407,17393656,17396812,17400580,17417292,17418406,17420637,17429146,17429182,17440016,17443666,17452996,17455520,17456578,17468128,17469242,17472420,17473875,17474325,17478362,17482127,17487261,17487491,17494873,17495700,17497651,17499457,17501419,17501738,17504596,17507113,17511321,17512952,17514337,17516702,17516982,17522402,17524700,17526259,17534641,17549410,17554755,17556771,17562228,17573378,17575234,17575686,17576145,17581521,17585581,17586500,17586556,17605360,17614118,17620467,17633739,17634060,17641462,17641541,17653993,17656539,17663717,17665529,17669566,17676462,17676465,17677037,17685806,17689290,17700840,17702880,17722093,17727139,17748343,17750123,17750942,17754248,17761759,17767131,17767758,17767973,17768796,17791440,17796867,17802807,17813267,17813520,17817155,17817836,17818631,17825973,17826821,17827352,17827655,17838253,17839297,17868686,17872107,17872718,17882609,17883943,17886313,17887848,17888840,17888872,17893439,17893668,17900778,17916757,17929554,17934823,17935181,17941276,17945638,17946261,17952982,17959153,17959827,17963297,17965200,17965649,17974808,17977253,17980539,17982249,17983371,17984616,18002831,18003146,18005100,18007247,18010795,18012669,18016214,18017524,18021946,18044848,18046798,18050000,18052582,18072208,18079962,18083853,18095844,18102127,18120166,18120517,18121176,18126400,18133820,18134899,18137739,18138485,18140507,18141130,18143070,18144730,18149480,18152442,18159089,18159186,18161749,18162459,18162738,18166378,18166423,18168032,18169947,18172739,18173867,18175934,18176089,18179939,18183610,18184973,18192862,18202062,18217626,18219402,18223498,18229062,18229533,18235081,18235837,18242667,18261454,18263525,18264620,18265476,18266602,18269019,18271221,18279040,18280775,18282788,18286706,18293597,18294450,18295639,18297214,18303003,18311433,18315506,18336103,18340543,18345304,18356036,18359645,18362425,18368154,18373434,18386718,18387416,18389988,18393908,18396814,18397162,18405406,18410240,18425253,18442240,18445051,18451103,18465441,18465944,18467249,18482933,18483243,18488033,18493657,18495856,18500891,18501732,18507129,18508729,18520982,18525663,18526501,18541440,18544446,18545761,18546014,18546088,18547546,18553488,18553917,18557330,18562884,18572937,18573399,18577522,18596101,18598078,18603231,18603420,18604064,18605865,18606476,18609426,18609797,18616879,18617548,18617829,18625192,18628955,18646902,18648769,18656190,18667922,18668317,18670670,18672748,18676483,18696913,18702970,18734277,18749434,18750964,18754241,18760954,18787962,18795408,18796074,18811766,18818768,18819683,18845099,18847679,18849026,18855390,18855903,18857852,18858061,18868399,18869503,18870423,18873569,18874661,18878196,18897075,18898611,18904737,18916281,18917733,18918010,18926518,18930449,18933145,18935112,18937258,18939726,18945292,18953896,18955849,18957023,18957544,18960660,18977457,18982216,18984466,18985185,19011363,19012859,19019538,19023081,19024381,19028678,19031118,19031933,19033637,19038128,19056919,19057296,19062043,19076641,19083074,19083759,19084404,19087699,19090362,19090538,19101934,19111851,19124952,19127091,19130234,19133031,19134399,19138634,19143992,19153042,19154275,19155099,19157725,19159670,19160452,19177227,19193686,19200666,19207142,19211521,19213363,19219307,19228094,19231194,19231886,19243082,19252184,19262566,19274871,19277416,19277765,19287163,19295015,19298143,19302437,19304683,19306146,19312667,19318714,19320081,19325567,19326714,19328668,19328679,19336060,19351531,19355480,19356228,19360428,19364803,19368057,19384019,19388362,19403485,19411515,19411785,19415754,19417311,19419485,19420479,19423644,19439442,19441239,19444353,19455267,19455447,19462805,19471798,19475854,19478345,19478677,19484320,19486251,19487080,19496380,19503733,19505241,19506700,19510169,19516093,19518718,19518771,19525358,19527335,19530382,19535532,19537050,19540701,19541708,19551998,19557443,19572136,19580922,19582311,19587687,19588241,19588647,19590602,19598318,19603982,19605829,19608723,19610498,19621990,19622716,19625128,19628164,19635445,19644006,19644114,19647398,19649701,19661324,19666523,19667438,19684633,19690261,19691252,19692069,19700574,19709269,19714368,19717902,19718411,19721649,19724871,19733472,19738647,19738728,19739668,19742632,19744212,19745401,19758018,19759313,19759393,19764917,19769906,19772589,19775232,19781336,19784346,19784632,19793050,19793111,19800396,19800926,19806042,19810335,19811537,19819540,19820326,19824241,19825046,19830186,19830324,19838760,19840668,19840803,19851436,19851802,19854887,19856073,19860347,19864066,19865458,19866845,19881980,19891309,19907601,19921927,19926207,19927237,19940649,19943520,19944752,19945845,19947167,19960865,19964000,19964395,19982567,19985149,19993003,20002379,20005237,20006179,20010516,20025859,20027594,20028469,20029244,20040600,20057143,20067150,20072985,20074677,20097328,20097985,20099995,20103586,20105255,20111020,20118268,20118864,20126501,20128438,20129442,20136438,20139860,20140144,20162488,20166624,20167329,20167396,20168412,20168415,20170374,20177713,20179548,20179631,20196510,20205977,20210060,20217790,20218202,20219743,20225670,20227088,20233621,20235479,20242346,20246247,20254401,20274875,20299730,20312363,20321002,20333237,20340853,20341673,20342853,20359324,20364187,20366784,20367382,20375760,20380862,20383764,20387504,20390568,20391861,20393982,20398919,20405039,20405210,20416392,20421108,20424046,20430244,20432470,20435306,20436877,20441630,20443091,20446620,20450378,20456102,20460396,20472862,20473130,20481509,20482995,20492128,20498049,20501023,20506710,20506753,20507725,20507755,20510929,20511056,20522528,20524715,20526365,20537102,20542630,20549520,20555546,20565190,20580796,20583858,20584797,20587939,20596118,20601312,20603449,20611874,20631012,20631109,20636816,20639568,20646336,20650599,20650617,20652675,20656543,20659984,20668379,20669250,20670379,20678474,20682476,20683108,20688681,20693250,20695911,20712633,20717036,20718766,20726485,20729981,20735578,20739696,20741706,20742056,20745885,20748167,20750594,20751324,20754097,20754204,20758440,20758598,20758871,20761360,20772889,20780372,20783740,20786102,20795438,20796752,20800752,20803325,20804513,20813092,20818994,20826787,20833276,20835651,20846301,20847216,20850260,20850410,20856802,20858745,20859195,20859949,20864540,20867061,20870254,20875422,20877163,20877438,20878292,20879588,20884340,20898485,20899143,20901921,20904518,20911136,20919142,20921084,20923205,20923366,20923878,20924293,20924989,20940099,20940490,20944815,20949839,20955072,20960741,20973890,20985615,20988823,21000226,21008327,21020718,21025476,21031705,21038383,21039363,21043572,21044470,21048572,21050549,21060406,21071407,21074364,21075492,21079254,21081544,21092648,21098151,21109108,21113757,21121067,21126615,21126700,21129099,21135714,21143329,21151168,21158392,21160039,21172480,21173315,21177943,21178883,21182740,21185924,21201587,21202973,21206832,21207207,21214962,21238329,21245121,21245171,21250345,21252940,21256764,21257073,21258677,21260994,21269508,21271744,21297088,21298012,21300702,21302480,21306587,21307403,21310271,21314389,21324884,21328157,21333746,21342719,21343167,21345573,21348455,21355459,21355681,21361657,21362655,21367664,21380670,21386593,21387865,21388065,21392168,21396733,21398028,21398515,21399527,21405148,21405849,21409734,21410391,21413749,21419142,21420601,21423922,21427894,21429106,21446732,21457272,21458972,21461288,21468750,21472681,21474206,21474302,21484948,21489730,21495515,21509246,21509419,21517332,21554531,21556132,21556796,21568866,21580913,21588827,21594574,21599022,21609715,21618984,21622806,21622974,21626528,21633697,21647615,21649836,21655251,21662451,21663430,21671648,21696365,21704917,21721687,21726615,21733582,21733648,21744725,21746567,21748405,21754240,21758920,21771019,21771353,21772558,21773040,21791528,21799154,21799878,21800422,21801670,21809551,21810906,21812737,21826944,21827816,21828867,21829039,21831571,21837803,21838202,21838449,21847041,21847256,21850319,21854390,21863379,21863839,21878865,21883449,21889472,21893650,21901051,21903909,21909501,21915056,21916759,21924932,21941778,21952999,21955197,21980654,21995941,21999150,22000662,22013487,22014610,22015059,22019411,22021628,22021877,22031018,22033441,22035685,22037275,22037989,22041525,22046652,22047068,22053327,22054939,22061300,22062622,22071350,22071692,22078788,22080821,22081813,22086670,22088800,22089026,22090938,22093740,22094878,22100971,22110696,22111640,22114111,22115160,22125751,22135873,22149657,22153753,22154461,22157990,22158361,22158747,22167444,22181462,22182871,22183342,22183465,22184321,22197791,22204302,22214199,22219095,22225761,22226300,22240823,22241939,22242944,22253991,22262493,22272319,22275006,22276878,22294786,22298555,22304465,22305199,22316593,22320182,22325900,22326180,22334720,22339651,22343284,22345065,22347297,22347929,22352061,22352249,22353597,22358036,22369219,22373404,22377748,22385123,22385997,22393582,22394303,22394557,22400354,22406653,22410059,22410863,22414339,22420475,22422761,22425810,22439381,22445202,22448589,22455282,22468195,22470408,22477471,22484351,22484959,22490598,22491154,22502925,22505529,22505718,22514721,22515193,22535925,22542274,22545315,22549485,22551905,22558998,22559360,22575792,22584123,22587862,22589564,22589614,22593060,22605807,22609409,22620451,22622941,22629640,22636436,22639455,22641539,22647382,22648278,22651131,22658822,22662592,22669965,22676879,22679978,22680445,22681899,22689209,22691766,22699956,22705762,22709655,22709970,22714121,22716626,22718426,22721507,22726744,22729097,22733586,22739159,22739675,22744674,22748312,22751698,22754131,22756731,22763433,22765937,22769663,22775100,22776390,22778720,22781914,22785361,22786499,22789632,22794296,22796624,22803222,22804317,22818838,22828820,22832105,22834202,22834491,22842287,22847936,22864362,22873655,22878008,22911087,22924330,22929882,22936565,22939913,22951700,22953169,22954706,22957165,22957289,22958636,22963503,22963627,22969162,22969990,22970360,22973007,22975312,22980246,22985290,22987725,22988742,22989597,22991471,23007844,23008320,23022637,23027078,23028342,23029187,23031047,23031738,23037581,23042942,23047814,23055047,23056858,23061029,23063459,23070785,23077534,23080242,23084954,23086627,23088426,23096698,23100038,23107558,23124727,23125846,23134798,23135483,23146875,23149523,23152021,23154598,23159764,23163861,23167889,23169526,23181342,23181890,23191219,23192416,23197780,23208577,23233663,23241802,23242160,23245547,23252405,23255240,23258534,23270360,23272381,23272453,23277413,23286461,23302352,23312454,23314650,23316295,23319540,23348861,23350683,23354655,23362109,23362477,23363326,23363473,23363596,23364995,23366583,23373522,23381229,23383360,23390200,23391840,23396536,23402082,23407199,23413082,23413090,23413337,23413889,23416577,23419970,23423960,23427559,23430081,23433664,23442337,23444962,23446414,23469302,23470121,23474079,23485869,23488781,23495863,23498407,23504569,23514322,23514620,23514906,23521520,23535686,23536407,23538293,23542512,23545318,23546090,23547437,23549370,23556500,23564211,23567090,23577700,23585578,23592426,23592909,23604303,23604773,23612117,23617854,23619713,23623031,23639317,23645301,23648651,23650727,23653161,23655672,23657212,23658801,23675922,23676494,23679212,23685163,23685416,23691330,23691337,23697005,23706706,23707436,23711156,23712836,23715213,23724121,23724177,23731716,23739323,23744091,23755206,23759050,23765795,23771560,23780311,23783095,23786282,23801186,23810830,23811447,23829378,23832560,23834694,23841652,23844196,23846028,23849616,23852493,23855338,23861062,23862410,23864447,23865377,23865384,23870595,23873003,23876308,23882911,23883067,23889230,23889645,23891121,23894204,23897664,23902799,23903150,23908016,23911473,23911824,23917258,23919584,23931509,23937232,23941700,23947388,23947794,23949401,23952048,23953046,23955155,23956080,23957859,23972819,23977149,23980482,23981526,23981688,23982533,23989260,23992543,24004926,24010623,24016134,24019311,24020973,24023593,24029261,24040051,24041774,24049426,24050228,24050777,24062715,24072424,24083220,24086617,24090746,24096487,24098716,24101111,24101579,24102685,24102976,24104857,24106042,24120505,24124819,24126374,24141855,24142301,24143122,24156726,24162754,24165104,24174558,24175428,24175466,24177981,24180779,24182929,24189086,24193038,24200653,24201795,24216857,24233086,24244936,24245617,24251889,24267195,24274213,24276145,24277648,24285608,24286229,24290331,24294416,24302299,24313066,24318663,24321713,24328840,24337382,24352738,24354805,24360619,24364669,24378775,24392610,24398945,24399589,24404966,24407751,24409452,24413614,24417000,24432682,24434629,24439123,24441654,24453288,24464442,24476608,24477053,24479461,24485072,24490951,24493160,24500835,24504494,24507283,24511786,24525691,24534498,24535830,24536037,24546715,24553652,24554820,24557449,24559315,24563152,24567013,24570923,24577221,24586613,24589520,24592339,24594774,24600600,24600804,24602808,24605355,24613929,24614941,24626858,24630051,24635482,24638330,24640499,24641446,24648058,24650045,24659060,24667685,24667794,24672541,24675658,24676131,24696990,24699437,24700362,24702401,24707165,24710671,24713207,24714715,24722730,24729770,24731545,24740051,24746120,24748161,24750312,24761091,24762768,24776529,24776782,24796074,24797887,24802149,24811013,24813768,24814177,24815409,24816588,24817965,24826326,24833500,24837220,24843357,24851282,24860088,24864596,24873672,24874090,24878416,24880539,24883962,24892135,24894084,24899764,24901618,24909849,24915050,24915799,24921996,24924064,24931877,24932287,24937965,24940080,24942620,24943380,24951380,24951695,24952452,24953625,24955822,24958022,24959562,24961117,24963848,24967502,24980650,24981161,24985385,24990503,24997437,24998769,24999951,25002771,25003397,25011220,25013207,25014904,25025119,25028190,25038195,25049102,25054082,25055832,25060237,25064391,25064402,25065322,25071409,25116966,25117171,25120465,25122174,25148634,25149752,25156835,25167509,25167520,25167895,25176272,25178119,25193059,25193706,25196391,25197633,25203534,25204940,25220313,25220999,25237636,25239633,25241132,25245233,25246161,25251156,25266273,25266425,25270160,25277742,25288077,25288161,25289477,25290356,25307142,25309757,25312198,25318609,25324012,25327409,25327454,25328449,25338921,25343750,25350701,25354887,25356151,25358052,25358282,25361723,25362186,25363526,25364687,25364759,25365657,25368829,25371151,25372832,25381225,25384728,25385644,25386176,25387133,25387202,25391201,25400065,25412898,25422731,25423626,25432169,25433786,25435611,25441301,25445370,25449660,25450573,25451358,25452241,25452264,25454243,25468239,25470722,25471084,25473751,25488133,25493070,25497996,25506900,25511360,25512467,25528508,25541337,25544792,25550621,25552344,25558567,25561280,25565066,25567650,25573515,25575840,25576062,25583036,25587011,25587500,25591897,25592251,25595313,25595636,25605064,25606211,25606918,25609730,25610434,25616934,25622144,25627159,25631230,25647380,25654641,25660645,25664366,25671948,25679135,25680613,25693327,25696393,25697806,25704311,25713657,25726420,25728288,25740654,25748402,25748822,25749005,25749071,25755369,25757934,25761840,25764646,25767469,25779030,25793811,25794339,25795477,25801951,25810257,25811972,25818446,25818513,25819980,25822668,25823795,25827738,25829501,25830161,25833263,25835428,25835587,25835842,25838223,25840295,25840950,25843477,25853752,25854335,25885451,25887341,25895737,25899659,25902749,25904081,25905464,25907637,25907905,25912532,25918069,25920638,25920718,25926615,25938053,25939741,25942561,25947206,25958086,25959474,25960217,25997475,25998646,26011981,26014420,26020689,26021656,26022849,26023775,26035550,26039663,26044527,26045079,26045230,26059991,26061947,26063356,26065242,26066943,26071032,26071682,26085002,26090915,26095482,26105188,26105699,26107001,26110856,26114311,26114949,26133370,26137795,26142721,26143291,26161256,26173833,26179796,26181610,26185974,26193584,26197834,26199914,26204441,26222167,26223396,26234518,26246098,26256576,26263221,26265881,26266585,26266815,26279471,26286105,26290412,26292002,26293812,26296616,26297901,26306184,26308821,26311338,26311917,26315468,26331954,26332510,26333573,26339631,26345973,26346284,26350067,26356668,26361696,26364691,26372719,26374056,26375722,26379039,26395132,26395887,26399535,26400542,26401128,26403209,26404928,26406022,26408089,26414193,26418615,26426087,26428094,26428397,26453330,26454810,26456191,26458065,26462674,26471328,26475052,26475649,26476983,26484987,26486266,26491728,26497936,26500642,26508990,26510557,26511030,26511105,26512051,26515544,26516092,26531936,26533296,26534039,26536246,26536864,26538426,26539537,26546733,26548678,26553970,26555317,26566187,26570443,26576842,26580159,26581622,26585770,26594903,26597595,26599015,26609689,26627124,26630980,26632768,26634982,26636511,26638896,26641740,26644688,26660524,26686398,26687196,26689207,26698860,26702784,26705831,26706842,26714285,26724072,26726867,26731584,26737404,26768595,26770289,26785486,26788446,26799051,26802045,26805770,26820288,26822442,26825905,26826265,26835501,26836321,26837117,26841779,26843296,26864717,26866502,26873992,26880043,26900926,26902437,26904247,26904781,26906526,26913958,26916572,26923351,26924080,26924505,26932690,26933434,26940584,26944070,26946977,26947442,26949677,26954260,26959611,26965582,26971334,26977928,26978278,26982053,26993270,26997695,27002939,27005282,27007485,27009064,27022478,27030514,27031992,27042080,27048438,27058271,27058305,27067376,27069014,27070393,27076800,27078349,27079525,27081820,27081899,27082547,27084893,27087217,27087276,27089349,27096212,27101110,27108074,27108116,27112942,27113459,27113601,27115217,27119073,27121294,27125326,27127191,27131033,27134888,27136554,27140280,27145884,27158147,27167538,27173573,27186752,27190363,27198855,27205689,27209973,27213118,27216807,27218694,27226584,27226734,27241994,27246174,27251173,27257217,27261056,27282763,27284163,27291391,27291406,27293197,27306410,27313651,27335133,27345359,27349445,27361226,27365033,27371353,27381525,27382693,27382714,27385925,27392016,27392209,27407539,27409506,27418245,27420031,27420466,27424943,27425733,27441862,27449974,27455271,27460135,27460856,27464434,27480244,27481292,27486047,27487207,27489570,27498346,27499234,27499879,27505222,27512925,27512994,27515196,27516479,27522716,27524646,27535798,27537389,27543152,27544006,27544599,27564922,27564937,27566243,27567331,27569933,27574381,27578066,27592053,27601403,27604943,27606811,27621093,27621569,27622925,27623313,27626648,27646624,27655847,27660645,27667932,27676594,27682151,27687168,27689837,27691731,27697415,27699574,27701629,27702728,27707856,27709455,27714490,27719989,27720537,27736663,27745289,27752409,27752700,27760282,27768384,27769425,27771298,27771374,27777889,27791107,27798172,27799674,27813961,27815120,27815720,27816252,27816923,27817967,27835024,27835990,27841855,27843962,27850634,27851748,27854890,27859174,27862122,27865081,27875921,27881986,27882452,27888503,27888596,27896928,27898892,27899317,27905133,27912638,27914828,27915176,27915990,27918157,27919734,27920033,27920124,27923618,27934390,27941431,27941510,27954579,27961148,27963013,27967694,27973360,27981239,27984385,27986435,27986896,27988623,27989086,27993350,27997664,28002558,28006333,28006841,28007594,28013316,28014358,28028725,28029566,28036798,28044379,28052610,28070686,28073063,28085436,28086907,28089676,28094578,28108020,28120487,28130695,28134810,28136226,28138629,28140491,28146439,28163533,28166220,28178969,28185364,28189758,28196687,28209090,28211435,28211737,28212781,28221863,28222713,28224026,28226767,28236372,28237233,28241632,28245308,28246302,28255872,28256227,28266071,28269952,28295113,28296342,28297366,28299591,28302994,28303471,28314422,28327819,28329175,28335117,28338899,28342294,28351393,28354419,28358190,28360536,28361060,28362633,28365251,28367081,28384767,28389686,28389801,28392415,28396847,28406296,28407503,28410472,28410990,28421455,28423172,28429923,28433053,28433425,28439123,28439351,28439530,28440354,28443360,28452893,28457301,28459273,28465831,28465904,28476433};
	uint32_t size = sizeof(sorted) / sizeof(sorted[0]);
	printf("Processing %d elements\n", size);
	unsigned char *v1, *v2, *v3, *v4, *v5, *simdized;
	compress_v1(&v1, size, sorted);
	compress_v2(&v2, size, sorted);
	compress_v3(&v3, size, sorted);
	compress_v4(&v4, size, sorted);
	compress_v5(&v5, size, sorted);
	simdize(&simdized, size, sorted);

	double v1_time = 0;
	double v2_time = 0;
	double v3_time = 0;
	double v4_time = 0;
	double v5_time = 0;
	double un_time = 0;
	double simd_time = 0;

	clock_t start, end;
	for (int i = 0; i < 500000000; i += 1001) {
		if (i % 10000000 == 0) printf("i=%d\n", i);
		start = clock();
		bool v1_result = contains_v1(v1, i);
		end = clock();
		v1_time += ((double) (end - start)) / CLOCKS_PER_SEC;

		start = clock();
		bool v2_result = contains_v2(v2, i);
		end = clock();
		v2_time += ((double) (end - start)) / CLOCKS_PER_SEC;

		start = clock();
		bool v3_result = contains_v3(v3, i);
		end = clock();
		v3_time += ((double) (end - start)) / CLOCKS_PER_SEC;

		start = clock();
		bool v4_result = contains_v4(v4, i);
		end = clock();
		v4_time += ((double) (end - start)) / CLOCKS_PER_SEC;

		start = clock();		
		bool v5_result = contains_v5(v5, i);
		end = clock();
		v5_time += ((double) (end - start)) / CLOCKS_PER_SEC;		

		start = clock();
		bool gt = contains_uncompressed(size, sorted, i);
		end = clock();
		un_time += ((double) (end - start)) / CLOCKS_PER_SEC;

		start = clock();		
		bool simd = contains_simdized(size, simdized, i);
		end = clock();
		simd_time += ((double) (end - start)) / CLOCKS_PER_SEC;

		if (v1_result != v2_result || v2_result != v3_result || v3_result != v4_result || v4_result != v5_result || v5_result != gt || gt != simd) {
			printf("Discrepancy for %d\n", i);
			printf("v1=%d\n", v1_result);
			printf("v2=%d\n", v2_result);
			printf("v3=%d\n", v3_result);
			printf("v4=%d\n", v4_result);
			printf("v5=%d\n", v5_result);
			printf("simdized=%d\n", simd);
			printf("uncompressed=%d\n", gt);
			exit(1);
		}
	}

	printf("Success\n");
	printf("v1 time: %f seconds\n", v1_time);
	printf("v2 time: %f seconds\n", v2_time);
	printf("v3 time: %f seconds\n", v3_time);
	printf("v4 time: %f seconds\n", v4_time);
	printf("v5 time: %f seconds\n", v5_time);
	printf("uncompressed time: %f seconds\n", un_time);
	printf("simdized time: %f seconds\n", simd_time);
	free(v1);
	free(v2);
	free(v3);
	free(v4);	
	free(simdized);	
	return 0;
}

uint32_t* generate_list(uint32_t n) {
	uint32_t* list = (uint32_t*) malloc(n * sizeof(uint32_t*));
	double scale = 1;
	double shape = 1;

	uint32_t cur = 1;
	for (uint32_t i = 0; i < n; i++) {
		double r = ((double) rand() / (RAND_MAX));
		cur = (uint32_t) ceil(cur + (scale / pow(r, 1 / shape)));
		list[i] = cur;
	}
	return list;
}

int main() {
	srand(time(NULL));
	for (uint32_t p = 16; p < 26; p++) {
		uint32_t n = (uint32_t) pow(2, p);
		uint32_t* list = generate_list(n);
		uint32_t max_num = list[n - 1];
		printf("===== TIMINGS FOR p=%d =====\n", p);
		printf("===== Operations=%d =====\n", max_num);
		timings(n, list, max_num);
	}
}
